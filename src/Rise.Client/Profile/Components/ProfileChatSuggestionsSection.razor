@using System.Linq

<section class="mt-6">
    <h3 class="mb-2 text-sm font-medium text-neutral-700">Gesprekssuggesties</h3>
    <div class="rounded-2xl border border-neutral-200 bg-white p-4">
        <div class="mb-3 flex items-center justify-between gap-2 text-sm font-semibold text-neutral-700">
            <div class="flex items-center gap-2">
                <span class="flex h-7 w-7 items-center justify-center rounded-full bg-neutral-100 text-neutral-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v7a2 2 0 01-2 2h-2M7 8H5a2 2 0 00-2 2v7a2 2 0 002 2h2m10-11V5a2 2 0 00-2-2H9a2 2 0 00-2 2v3m10 0H7m10 0v3m-4 4h.01" />
                    </svg>
                </span>
                <span>Voorstelzinnen voor chat</span>
            </div>
            @if (IsEditing)
            {
                <span class="text-xs font-medium text-neutral-500">@Suggestions.Count/@MaxSuggestions</span>
            }
        </div>
        <div class="min-h-[36px] flex flex-wrap gap-2">
            @if (Suggestions.Any())
            {
                @foreach (var suggestion in Suggestions)
                {
                    <span class="inline-flex items-center gap-2 rounded-full border border-neutral-300 bg-white px-3 py-1 text-sm text-neutral-700 shadow-sm">
                        <span class="font-medium">@suggestion</span>
                        @if (IsEditing)
                        {
                            <button type="button" class="ml-1 rounded-full p-0.5 text-neutral-500 hover:bg-neutral-100" @onclick="() => HandleRemoveSuggestion(suggestion)" aria-label='@($"Verwijder {suggestion}")'>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                        }
                    </span>
                }
            }
            else if (IsEditing)
            {
                <span class="text-sm text-neutral-500">Kies tot @MaxSuggestions zinnen die je handig vindt.</span>
            }
            else
            {
                <span class="text-sm text-neutral-500">Er zijn nog geen gesprekssuggesties ingesteld.</span>
            }
        </div>
        @if (IsEditing)
        {
            <button type="button" class="mt-3 w-full rounded-xl bg-[#127646] px-4 py-3 text-sm font-medium text-white shadow hover:bg-[#0f663c] active:scale-[0.99]" @onclick="HandleManageSuggestions">
                Kies gesprekssuggesties
            </button>
        }
    </div>
</section>

@code {
    [Parameter] public IReadOnlyList<string> Suggestions { get; set; } = Array.Empty<string>();
    [Parameter] public bool IsEditing { get; set; }
    [Parameter] public int MaxSuggestions { get; set; }
    [Parameter] public EventCallback OnManageSuggestions { get; set; }
    [Parameter] public EventCallback<string> OnRemoveSuggestion { get; set; }

    private Task HandleManageSuggestions() => OnManageSuggestions.InvokeAsync();
    private Task HandleRemoveSuggestion(string suggestion) => OnRemoveSuggestion.InvokeAsync(suggestion);
}
