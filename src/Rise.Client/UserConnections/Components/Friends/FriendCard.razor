@using Rise.Shared.Assets

<article class="friend-card flex flex-col items-start gap-3 rounded-2xl bg-white px-3 py-3 shadow-sm sm:flex-row sm:items-center sm:gap-4 sm:px-4 sm:py-4 lg:gap-5"
         @onclick="() => NavigateToFriendProfile(Friend, PageContext)">
    <img src="@(Friend.User.AvatarUrl)" alt="@Friend.User.Name" class="h-10 w-10 shrink-0 rounded-full border border-neutral-200 object-cover sm:h-12 sm:w-12" />
    <div class="flex-1 min-w-0">
        <p class="text-sm font-medium truncate">@Friend.User.Name</p>
        <span class="inline-block mt-1 text-[10px] px-2 py-0.5 rounded-md bg-[#e7f5ec] text-[#127646] border border-[#cfead9]">
            @Friend.User.Age jaar
        </span>
    </div>

    <div class="flex w-full flex-wrap gap-2 sm:w-auto sm:flex-nowrap sm:items-center sm:justify-end">
        @if (PageContext == UserConnectionTypeDto.AddFriends)
        { 
            <button class="h-12 w-12 grid place-items-center text-white rounded-xl bg-[#127646] hover:bg-[#0f613a]"
                    aria-label="Toevoegen"
                    @onclick="(() => OnAdd.InvokeAsync(Friend))" @onclick:stopPropagation="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 256 256"><path d="M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"></path></svg>
        </button>
        }
        else if (Friend.State == UserConnectionTypeDto.IncomingFriendRequest)
        {
            <button class="h-12 w-12 grid place-items-center text-white rounded-xl bg-[#D64541] hover:bg-[#c53e3a]" aria-label="Verwijderen"
                    @onclick="(() => OnReject.InvokeAsync(Friend))" @onclick:stopPropagation="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 256 256"><path d="M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM112,168a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm0-120H96V40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8Z"></path></svg>
           </button>
            <button class="h-12 w-12 grid place-items-center rounded-xl text-white bg-[#127646] hover:bg-[#0f613a]" aria-label="Accepteren"
                    @onclick="(() => OnAccept.InvokeAsync(Friend))" @onclick:stopPropagation="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 256 256"><path d="M232.49,80.49l-128,128a12,12,0,0,1-17,0l-56-56a12,12,0,1,1,17-17L96,183,215.51,63.51a12,12,0,0,1,17,17Z"></path></svg>
          </button>
        }
        else if (Friend.State == UserConnectionTypeDto.OutgoingFriendRequest)
        {
            <button class="h-12 w-12 grid place-items-center text-white rounded-xl bg-[#D64541] hover:bg-[#c53e3a]" aria-label="Verwijderen"
                    @onclick="(() => OnCancel.InvokeAsync(Friend))" @onclick:stopPropagation="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 256 256"><path d="M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM112,168a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm0-120H96V40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8Z"></path></svg>
            </button>
        }

        else
        {
            <button class="h-12 w-12 grid place-items-center rounded-xl text-white bg-[#127646] hover:bg-[#0f613a]" aria-label="Open chat"
                    @onclick="(() => OnOpenChat.InvokeAsync(Friend))" @onclick:stopPropagation="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 256 256"><path d="M216,48H40A16,16,0,0,0,24,64V224a15.84,15.84,0,0,0,9.25,14.5A16.05,16.05,0,0,0,40,240a15.89,15.89,0,0,0,10.25-3.78l.09-.07L83,208H216a16,16,0,0,0,16-16V64A16,16,0,0,0,216,48ZM160,152H96a8,8,0,0,1,0-16h64a8,8,0,0,1,0,16Zm0-32H96a8,8,0,0,1,0-16h64a8,8,0,0,1,0,16Z"></path></svg>
          </button>
            <button class="h-12 w-12 grid place-items-center rounded-xl text-white bg-[#D64541] hover:bg-[#c53e3a]" aria-label="Verwijderen"
                    @onclick="(() => OnRemove.InvokeAsync(Friend))" @onclick:stopPropagation="true">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 256 256"><path d="M216,48H176V40a24,24,0,0,0-24-24H104A24,24,0,0,0,80,40v8H40a8,8,0,0,0,0,16h8V208a16,16,0,0,0,16,16H192a16,16,0,0,0,16-16V64h8a8,8,0,0,0,0-16ZM112,168a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm48,0a8,8,0,0,1-16,0V104a8,8,0,0,1,16,0Zm0-120H96V40a8,8,0,0,1,8-8h48a8,8,0,0,1,8,8Z"></path></svg></button>
        }
    </div>
</article>

@code {
    [Parameter] public UserConnectionDto.Get Friend { get; set; } = default!;
    [Parameter] public EventCallback<UserConnectionDto.Get> OnAccept { get; set; }
    [Parameter] public EventCallback<UserConnectionDto.Get> OnReject { get; set; }
    [Parameter] public EventCallback<UserConnectionDto.Get> OnCancel { get; set; }
    [Parameter] public EventCallback<UserConnectionDto.Get> OnAdd { get; set; }
    [Parameter] public EventCallback<UserConnectionDto.Get> OnOpenChat { get; set; }
    [Parameter] public EventCallback<UserConnectionDto.Get> OnRemove { get; set; }
    [Parameter] public UserConnectionTypeDto PageContext { get; set; } = UserConnectionTypeDto.Friend;
    [Inject] private NavigationManager NavigationManager { get; set; } = default!;
    
    private void NavigateToFriendProfile(UserConnectionDto.Get friend, UserConnectionTypeDto context)
    {
        NavigationManager.NavigateTo($"/FriendProfilePage/{friend.User.AccountId}?context={context}");
    }

}
