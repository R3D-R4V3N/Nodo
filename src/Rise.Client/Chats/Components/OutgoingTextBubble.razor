@* Uitgaande tekstbubbel *@
<div class="flex justify-end items-center gap-2">
    <div class="@BubbleClasses"
         role="@(CanCancelPending ? "button" : null)"
         @onclick="HandlePendingClick">
        @Text
    </div>

    @if (IsPending)
    {
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="currentColor"
             class="h-5 w-5 text-red-600" title="Wacht op verzending">
            <path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm-8,56a8,8,0,0,1,16,0v56a8,8,0,0,1-16,0Zm8,104a12,12,0,1,1,12-12A12,12,0,0,1,128,184Z"></path>
        </svg>
    }
</div>

@code {
    [Parameter] public string Text { get; set; } = string.Empty;
    [Parameter] public bool IsPending { get; set; }
    [Parameter] public EventCallback OnCancelPending { get; set; }

    private string BubbleClasses => IsPending
        ? $"py-2 shadow-sm text-sm max-w-[80%] border-2 border-red-500 border-dashed focus:outline-none focus:ring-2 focus:ring-red-300{(CanCancelPending ? " cursor-pointer" : string.Empty)}"
        : "bg-[#127646] text-white rounded-2xl rounded-tr-none px-4 py-2 text-sm shadow-sm max-w-[80%]";

    private bool CanCancelPending => IsPending && OnCancelPending.HasDelegate;

    private Task HandlePendingClick()
    {
        if (!CanCancelPending)
        {
            return Task.CompletedTask;
        }

        return OnCancelPending.InvokeAsync();
    }
}
