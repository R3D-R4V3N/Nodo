@page "/register"
@using Rise.Client.Identity.Components
@using Rise.Client.Home.Components
@layout EmptyLayout

<PageTitle>Register</PageTitle>

<AuthorizeView Context="authContext">
    <Authorized>
        <AuthLayout>
            <HeaderContent>
                <HomeLogo />
                <HomeHeading />
            </HeaderContent>
            <ChildContent>
                <div class="space-y-4 rounded-3xl bg-white/70 p-6 text-center shadow-xl backdrop-blur">
                    <p class="text-lg font-semibold text-[#04320C]">You're already logged in as @authContext.User.Identity?.Name.</p>
                </div>
            </ChildContent>
        </AuthLayout>
    </Authorized>
    <NotAuthorized>
        <AuthLayout>
            <HeaderContent>
                <HomeLogo />
                <HomeHeading />
            </HeaderContent>
            <ChildContent>
                @if (_result?.IsSuccess == true)
                {
                    <div class="space-y-4 rounded-3xl bg-white/70 p-6 text-center shadow-xl backdrop-blur">
                        <p class="text-lg font-semibold text-[#04320C]">Je aanvraag is verstuurd!</p>
                        <p class="text-sm text-zinc-600">Een begeleider bekijkt je registratie en keurt deze goed voordat je kan inloggen.</p>
                        <a href="/login" class="inline-flex w-full items-center justify-center rounded-full bg-[#0B6532] py-3 text-lg font-semibold text-white shadow-md transition hover:bg-[#0a572b]">
                            Ga naar login
                        </a>
                    </div>
                }
                else
                {
                    <AuthErrorList Errors="_result?.Errors as IReadOnlyCollection<string>" />
                    @if (!string.IsNullOrEmpty(_loadError))
                    {
                        <div class="mb-4 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700">
                            @_loadError
                        </div>
                    }
                    <RegisterForm Model="Model"
                                  OnSubmit="RegisterUserAsync"
                                  Organizations="_organizations"
                                  IsProcessing="_isSubmitting" />
                }
            </ChildContent>
        </AuthLayout>
    </NotAuthorized>
</AuthorizeView>
